# BE-01 — Инфраструктура: Развертывание в РФ-контуре

### 1. Архитектурный анализ (CoT)
Фича реализуется на уровне инфраструктуры из arch.md: три сервиса Docker (frontend, backend, db). Требуется обеспечить размещение в РФ (данные не покидают территорию) и целевую метрику RTO &lt; 24ч за счёт контейнеризации и процедур восстановления.

### 2. Описание и цель
Техническое развертывание приложения в российском контуре с использованием Docker/Docker Compose. Цель — выполнение требований 152-ФЗ по локализации данных и обеспечение восстановления в течение 24 часов.

### 3. Функциональные требования
* **SR-BE01-001:** Система должна разворачиваться как набор контейнеров: `frontend`, `backend`, `db`.
* **SR-BE01-002:** Сервис `db` должен использовать официальный образ PostgreSQL с персистентными томами.
* **SR-BE01-003:** Сервис `backend` должен запускаться под управлением Uvicorn/Gunicorn.
* **SR-BE01-004:** Сервис `frontend` должен отдавать статический бандл React через Nginx.
* **SR-BE01-005:** Документация/скрипты развертывания должны допускать размещение всех сервисов на площадке в РФ (без явного выноса данных за границу).

### 4. Сценарий использования
**Триггер:** Необходимость развернуть или восстановить стенд.
**Main Success Scenario:**
1. Оператор запускает `docker-compose up -d`.
2. Система поднимает три контейнера и обеспечивает доступ к приложению.
**Alternative Flows:**
* **AF-1 (Сбой образа):** Если образ недоступен, система логирует ошибку; оператор использует локально собранные образы.
* **AF-2 (Порт занят):** Если порт занят, docker-compose завершается с ошибкой; оператор меняет маппинг портов в конфигурации.

### 5. Модель данных
Не применимо (инфраструктура).

### 6. Интеграции и API
Не применимо.

### 7. Нефункциональные требования
* **Security:** Конфигурация не должна содержать мастер-ключи шифрования в репозитории; ключ подаётся в контейнер бэкенда исключительно через Docker Secrets или bind mount (см. BE-02). **Архитектурная изоляция:** секрет с мастер-ключом пробрасывается ИСКЛЮЧИТЕЛЬНО в контейнер Backend. Контейнер Database (PostgreSQL) физически не должен иметь доступа к этому секрету или к директории с ключами шифрования.
* **Performance:** Старт всех контейнеров — в пределах разумного времени (ориентир &lt; 2 мин на типовом железе).
