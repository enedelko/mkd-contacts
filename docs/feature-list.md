# Список функциональных задач (Feature List)

Соответствие SRS: [docs/srs/00-INDEX.md](srs/00-INDEX.md). Реализованные спецификации — 02–13; остальные фичи — [98-backlog.md](srs/98-backlog.md).

**Условные обозначения статуса:** Готово = реализовано; Бэклог = ещё не сделано.

| ID | Задача | Приоритет | Зависимости (Пререквизиты) | Статус |
|:---|:---|:---|:---|:---|
| **BE-01** | Инфраструктура: развёртывание в РФ-контуре. Docker Compose (frontend, backend, db). Nginx на хосте — единственная точка входа (80/443); порты контейнеров только на localhost. RTO &lt; 24 ч. | Core | — | Готово |
| **LOST-01** | Схема БД и миграции: admins, premises (PK — кадастровый номер), contacts, oss_voting. Alembic. | Core | BE-01 | Готово |
| **BE-02** | Шифрование ПДн: phone, email, telegram_id, «Обращение» (how_to_address). Blind Index (HMAC-SHA256) для поиска без расшифровки. | Критический | LOST-01 | Готово |
| **ADM-01** | Auth: Telegram OAuth, сверка с белым списком (таблица admins), выдача JWT. | Критический | BE-01 | Готово |
| **ADM-04** | Super-admin UI: добавление/удаление администраторов. Bootstrap первого админа — INSERT в admins через SQL (03). | Критический | ADM-01 | Готово |
| **CORE-01** | Импорт реестра: загрузка CSV/XLS (кадастры, площади, контакты). Валидация колонок, дедупликация по Blind Index. Реестр без ФИО. | Core | LOST-01, BE-02 | Готово |
| **LOST-02** | Страница загрузки реестра: UI, инструкция, валидация. Вызов CORE-01 (требуется авторизация админа). | Core | CORE-01, ADM-01 | Готово |
| **FE-03** | Каскадные фильтры помещений: Подъезд → Этаж → Тип → Номер. premise_id = кадастровый номер. | Core | CORE-01 | Готово |
| **FE-04** | Форма сбора данных: поля анкеты, «Электронный дом», согласия, капча (Turnstile). POST /api/submit. | Core | FE-03, CORE-02 | Готово |
| **CORE-02** | Валидация и лимиты при приёме анкеты: проверка форматов, лимит 10 невалидированных на помещение, дедупликация по Blind Index. | Критический | BE-02, CORE-01 | Готово |
| **VAL-01** | Валидация: смена статуса контакта (валидирован / неактуальный). API PATCH /api/admin/contacts/{id}/status. Аудит смены (BE-03). | Критический | ADM-01, CORE-02 | Готово |
| **ADM-03** | Добавление контакта админом: форма, авто-статус «валидирован». POST /api/admin/contacts. | Средний | CORE-02, ADM-01 | Готово |
| **BE-03** | Аудит-лог: INSERT, UPDATE, DELETE, SELECT; связь событий без раскрытия ПДн (Blind Index / entity_id). Запись IP клиента (X-Forwarded-For / X-Real-IP). | Критический | VAL-01 | Готово |
| **BE-04** | Защита: Rate limiting (10 зап/час с IP), капча Turnstile. Счётчики в PostgreSQL (Redis не в стеке). | Критический | BE-01 | Готово |
| **CORE-03** | Жизненный цикл контактов: UI «Ручной аудит контактов после импорта» — просмотр по помещениям, фильтры по статусу, смена статуса (VAL-01). Реестр без ФИО — автоматическая архивация по смене собственника не выполняется. | Критический | VAL-01, BE-03 | Готово |
| **CORE-04** | Математика кворума: базовый расчёт долей (площадь «ЗА» / общая площадь), API. | Критический | CORE-01 | Готово |
| **ADM-06** | Импорт только контактов (CSV/XLS/XLSX): кадастр + контакты, валидация, доступ — любой админ. | Средний | CORE-01, ADM-01 | Готово |
| **ADM-07** | Интерфейс загрузки контактов: блок на странице загрузки для админов (без суперадмина). | Средний | ADM-06 | Готово |
| **ADM-08** | Шаблон контактов по подъезду: выбор подъезда, выдача XLSX, аудит формирования. | Средний | ADM-06, BE-03 | Готово |
| **ADM-09** | Согласие администратора с Политикой (152-ФЗ): страница принятия ответственности за ПДн при первом входе; фиксация версии и даты в БД; аудит; 403 по админ-эндпоинтам без согласия. | Критический | ADM-01, BE-03 | Готово |
| **FE-01** | SVG-навигация: 3 уровня (подъезд → этаж → помещение), id = cadastral_number. | Высокий | CORE-01 | Бэклог |
| **FE-02** | Легенда на карте: 5 состояний (нет данных, невалидированные, часть/все валидированы, выбранное). | Высокий | CORE-04, FE-01 | Бэклог |
| **UI-01** | EntrancePicker: переиспользуемый компонент выбора подъезда (кнопки, бар, загрузка, сброс). Рефакторинг AdminContactsList, Upload. | Средний | FE-03 | Готово |
| **FE-06** | Главная: шахматка помещений по этажам; в ячейке — тип, номер, иконки ТГ/email, цвет по ОСС; клик → форма контакта или /admin/contacts. | Высокий | UI-01, FE-02, FE-04, ADM-03 | Готово |
| **FE-05** | sessionStorage и Nudge-модал: автозаполнение при переходе к другому помещению, подсказка заполнить паркинг/кладовку. | Высокий | FE-04 | Бэклог |
| **BOT-01** | Поиск в боте: нормализация ввода, regex кадастровых номеров, fuzzy (Левенштейн), парсинг типа/номера помещения. | Выше среднего | CORE-01 | Бэклог |
| **BOT-02** | Бот-анкета: линейный диалог, Share Contact, согласия. Отправка в тот же API (POST /api/submit или аналог). | Выше среднего | CORE-02, BOT-01 | Бэклог |
| **BOT-03** | Личный кабинет в боте: редактирование данных, «Право на забвение». | Выше среднего | BOT-02 | Бэклог |
| **BOT-04** | Синхронизация: данные из бота в общей БД; веб-клиент получает обновления при следующем запросе или по опросу. | Средний | FE-02, BOT-02 | Бэклог |
| **ADM-02** | Модерация: таблица контактов с фильтрами (IP, TimeRange), пакетный перевод в «Неактуальные». | Средний | BE-03, ADM-01 | Готово |
| **ADM-05** | Логирование действий суперадмина (добавление/удаление админов). | Средний | ADM-04 | Готово |
| **OPS-01** | Резервное копирование: ежедневные дампы на S3 (глубина 14 дней). | Низкий | BE-01 | Бэклог |
| **OPS-02** | Отказоустойчивость: страницы-заглушки при недоступности БД (503). | Низкий | BE-01 | Бэклог |
| **CORE-06** | Кворум: сложный расчёт (только помещения, где все валидированные контакты — «ЗА»). | Низкий | CORE-04 | Бэклог |
| **OPS-03** | Мониторинг: uptime-check, уведомление админов при недоступности. | Низкий | BE-01 | Бэклог |
