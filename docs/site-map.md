# Карта сайта (Site Map)

Маршруты фронтенда (React Router). Навигация зависит от наличия JWT в `localStorage` (авторизация через Telegram).

---

## 1. Неавторизованный пользователь

В шапке отображаются ссылки: **Главная** | **Выбор помещения** | **Войти через Telegram**.

| Путь | Страница | Доступ из навигации |
|------|----------|---------------------|
| `/` | Главная | Да (Главная) |
| `/premises` | Выбор помещения (каскадные фильтры) | Да |
| `/login` | Вход через Telegram (виджет) | Да (Войти через Telegram) |
| `/form` | Форма анкеты | **Нет** — только переход с «Выбор помещения» после выбора номера и нажатия «Перейти к форме анкеты» |
| `/auth/callback` | Callback после редиректа от Telegram | **Нет** — только редирект от Telegram Login Widget после успешного входа |
| `/upload` | Загрузка реестра | **Нет** — ссылка в навигации показывается только авторизованным; при прямом заходе по URL форма отображается, но выбор файла отключён (disabled) |

---

## 2. Авторизованный пользователь (админ)

В шапке отображаются ссылки: **Главная** | **Выбор помещения** | **Загрузка реестра**.

| Путь | Страница | Доступ из навигации |
|------|----------|---------------------|
| `/` | Главная | Да (Главная) |
| `/premises` | Выбор помещения | Да |
| `/form` | Форма анкеты | **Нет** — только с «Выбор помещения» (как у неавторизованного) |
| `/upload` | Загрузка реестра | Да (Загрузка реестра) |
| `/login` | Вход через Telegram | **Нет** — в навигации скрыта (показывается «Загрузка реестра»); при прямом заходе по URL страница входа доступна |
| `/auth/callback` | Callback после редиректа от Telegram | **Нет** — только редирект от Telegram |

---

## 3. Страницы, на которые нельзя попасть с главной по ссылке

Эти маршруты **не имеют ссылки на главной** (`/`) и в общем навбаре:

| Путь | Как попасть |
|------|-------------|
| **/form** | Только с страницы «Выбор помещения» (/premises): выбрать подъезд → этаж → тип → номер помещения, нажать «Перейти к форме анкеты». Переход выполняется с `state` (premise, entrance, floor, type). При прямом заходе на /form без state происходит редирект на /premises. |
| **/auth/callback** | Только редирект от Telegram после нажатия «Log in with Telegram» в виджете на /login. В URL приходят query-параметры (hash, id, first_name, …). |
| **/upload** (для неавторизованного) | В навигации не показывается; при прямом вводе URL страница открывается, но кнопка выбора файла отключена. |
| **/login** (для авторизованного) | В навигации не показывается (вместо неё — «Загрузка реестра»); при прямом вводе URL страница входа открывается. |

---

## 4. Схема переходов

```
Неавторизованный:
  /  ──┬── /premises ──► /form (после выбора помещения)
       └── /login ──► Telegram ──► /auth/callback ──► / (с токеном)

Авторизованный:
  /  ──┬── /premises ──► /form (после выбора помещения)
       └── /upload
```
